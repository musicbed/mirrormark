!function(e){"use strict";function t(e,t){var i={theme:"mirrormark",tabSize:"2",indentWithTabs:!0,lineWrapping:!0,extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"},mode:"markdown"};return _.assign(i,t),_.assign(Object.create(n),{element:e,options:i})}!function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e;else if("function"==typeof define&&define.amd)return define([],e);window&&(window.mirrorMark=e)}(t);var n={render:function(){this.registerKeyMaps(this.keyMaps),this.cm=e.fromTextArea(this.element,this.options),this.options.showToolbar&&this.setToolbar(this.tools)},setToolbar:function(e){var t=document.createElement("ul");t.className=this.options.theme+"-toolbar";var e=this.generateToolList(e);e.forEach(function(e){t.appendChild(e)});var n=this.cm.getWrapperElement();n.parentNode.insertBefore(t,n)},registerKeyMaps:function(e){for(var t in e){if("function"!=typeof this.actions[e[t]])throw"MirrorMark - '"+e[t]+"' is not a registered action";var n={};n[t]=this.actions[e[t]].bind(this),_.assign(this.options.extraKeys,n)}},registerActions:function(e){return _.assign(this.actions,e)},registerTools:function(e,t){for(var n in e)if(this.actions[e[n].action]&&"function"!=typeof this.actions[e[n].action])throw"MirrorMark - '"+e[n].action+"' is not a registered action";return t?void(this.tools=e):void(this.tools=this.tools.concat(e))},generateToolList:function i(e){return e.map(function(e){var t=document.createElement("li"),n=document.createElement("a");if(t.className=e.name,e.className&&(n.className=e.className),e.showName){var o=document.createTextNode(e.name);n.appendChild(o)}if(e.action&&(n.onclick=function(){this.cm.focus(),this.actions[e.action].call(this)}.bind(this)),t.appendChild(n),e.nested){t.className+=" has-nested";var s=document.createElement("ul");s.className=this.options.theme+"-toolbar-list";var r=i.call(this,e.nested);r.forEach(function(e){s.appendChild(e)}),t.appendChild(s)}return t}.bind(this))},tools:[{name:"bold",action:"bold",className:"fa fa-bold"},{name:"italicize",action:"italicize",className:"fa fa-italic"},{name:"blockquote",action:"blockquote",className:"fa fa-quote-left"},{name:"link",action:"link",className:"fa fa-link"},{name:"image",action:"image",className:"fa fa-image"},{name:"unorderedList",action:"unorderedList",className:"fa fa-list"},{name:"orderedList",action:"orderedList",className:"fa fa-list-ol"},{name:"fullScreen",action:"fullScreen",className:"fa fa-expand"}],keyMaps:{"Cmd-B":"bold","Cmd-I":"italicize","Cmd-'":"blockquote","Cmd-Alt-L":"orderedList","Cmd-L":"unorderedList","Cmd-Alt-I":"image","Cmd-H":"hr","Cmd-K":"link"},actions:{bold:function(){this.insertAround("**","**")},italicize:function(){this.insertAround("*","*")},code:function(){this.insertAround("```\r\n","\r\n```")},blockquote:function(){this.insertBefore("> ",2)},orderedList:function(){this.insertBefore("1. ",3)},unorderedList:function(){this.insertBefore("* ",2)},image:function(){this.insertBefore("![](http://)",2)},link:function(){this.insertAround("[","](http://)")},hr:function(){this.insert("---")},fullScreen:function(){var e=this.cm.getWrapperElement(),t=document,n=t.fullScreen||t.mozFullScreen||t.webkitFullScreen,i=function(){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},o=function(){t.cancelFullScreen?t.cancelFullScreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen&&t.webkitCancelFullScreen()};n?o&&o():i()}},insert:function(e){var t=this.cm.getDoc(),n=t.getCursor();t.replaceRange(e,{line:n.line,ch:n.ch})},insertAround:function(e,t){var n=this.cm.getDoc(),i=n.getCursor();if(n.somethingSelected()){var o=n.getSelection();n.replaceSelection(e+o+t)}else n.replaceRange(e+t,{line:i.line,ch:i.ch}),n.setCursor({line:i.line,ch:i.ch+e.length})},insertBefore:function(e,t){var n=this.cm.getDoc(),i=n.getCursor();if(n.somethingSelected()){var o=n.listSelections();o.forEach(function(i){for(var o=[i.head.line,i.anchor.line].sort(),s=o[0];s<=o[1];s++)n.replaceRange(e,{line:s,ch:0});n.setCursor({line:o[0],ch:t||0})})}else n.replaceRange(e,{line:i.line,ch:0}),n.setCursor({line:i.line,ch:t||0})}}}(window.CodeMirror);